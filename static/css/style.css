/* Capa base: scroll y transición suave */
body {
  position: relative;
  min-height: 100vh;
  margin: 0;
  padding-bottom: 120px;
  color: var(--text-dark, #2c3e50);
  background: linear-gradient(135deg, #e9edf5 0%, #f6f8fb 100%);
  transition: background 2s ease, color 1s ease;
  overflow: auto;
}

/* Capa de grano sutil */
body::before,
body::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

body::before {
  background-image: radial-gradient(circle, rgba(44,62,80,0.03) 1px, transparent 1px);
  background-size: 140px 140px;
  opacity: 0.22;
}

/* Capa visual de ciudad (ilustración) */
body::after {
  background: var(--scene, none);
  background-size: cover;
  background-position: center bottom;
  background-repeat: no-repeat;
  opacity: 0.9;
  transition: background 1s ease, opacity 1s ease, filter 1s ease;
}

/* --- Ejemplos de escenas Tokio --- */

/* Tokio despejado: skyline suave pastel */
body.city-tokyo.weather-clear {
  background: linear-gradient(135deg, #fdfbf7 0%, #e0f7fa 100%);
}
body.city-tokyo.weather-clear::after {
  --scene: url("data:image/svg+xml,%3Csvg width='1600' height='900' viewBox='0 0 1600 900' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='1600' height='900' fill='%23e9f2fb'/%3E%3Cpath d='M0 620 Q200 560 400 620 T800 620 T1200 620 T1600 620 V900 H0 Z' fill='%23d6e3f3'/%3E%3Cpath d='M200 520 h60 v180 h-60z M260 500 h50 v200 h-50z M340 540 h70 v160 h-70z' fill='%23c7d5eb'/%3E%3Cpath d='M680 480 h80 v220 h-80z M760 460 h60 v240 h-60z' fill='%23c0d0e6'/%3E%3Cpath d='M950 420 h110 v280 h-110z' fill='%23b6c8e0'/%3E%3Cpath d='M600 260 h20 v380 h-20z M610 240 h8 v400 h-8z' fill='%239fb4d4'/%3E%3Cpath d='M608 180 l16 60 h-32z' fill='%23f7cdbc'/%3E%3Cpath d='M0 650 C200 640 300 660 500 650 C700 640 850 660 1050 650 C1250 640 1400 660 1600 650 V900 H0 Z' fill='%23f5f8fc'/%3E%3C/svg%3E");
}

/* Tokio lluvia: misma silueta + overlay de lluvia muy tenue */
body.city-tokyo.weather-rain {
  background: linear-gradient(180deg, #d8e1e6 0%, #e6edf2 100%);
}
body.city-tokyo.weather-rain::after {
  --scene: url("data:image/svg+xml,%3Csvg width='1600' height='900' viewBox='0 0 1600 900' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='1600' height='900' fill='%23e3e8ef'/%3E%3Cpath d='M0 620 Q200 560 400 620 T800 620 T1200 620 T1600 620 V900 H0 Z' fill='%23cfd8e3'/%3E%3Cpath d='M200 520 h60 v180 h-60z M260 500 h50 v200 h-50z M340 540 h70 v160 h-70z' fill='%23c0cad9'/%3E%3Cpath d='M680 480 h80 v220 h-80z M760 460 h60 v240 h-60z' fill='%23b7c3d4'/%3E%3Cpath d='M950 420 h110 v280 h-110z' fill='%23adb9cc'/%3E%3Cpath d='M600 260 h20 v380 h-20z M610 240 h8 v400 h-8z' fill='%2397a7c0'/%3E%3Cpath d='M608 180 l16 60 h-32z' fill='%23d9c7c0'/%3E%3Cpath d='M0 650 C200 640 300 660 500 650 C700 640 850 660 1050 650 C1250 640 1400 660 1600 650 V900 H0 Z' fill='%23eef2f6'/%3E%3C/svg%3E");
  /* Lluvia fina */
  box-shadow:
    1px 10px 0 rgba(44,62,80,0.06),
    3px 30px 0 rgba(44,62,80,0.05),
    2px 50px 0 rgba(44,62,80,0.04);
  background-blend-mode: normal;
  animation: rain-fall 2s linear infinite;
  opacity: 0.9;
}

/* --- Overlays de clima globales, reutilizables --- */

/* Nubes suaves para cualquier ciudad */
body.weather-clouds::before {
  background:
    radial-gradient(ellipse at 18% 30%, rgba(255,255,255,0.32) 0%, rgba(255,255,255,0) 46%),
    radial-gradient(ellipse at 62% 42%, rgba(255,255,255,0.24) 0%, rgba(255,255,255,0) 52%),
    radial-gradient(ellipse at 40% 64%, rgba(255,255,255,0.18) 0%, rgba(255,255,255,0) 55%);
  filter: blur(9px);
  animation: clouds-drift 36s ease-in-out infinite alternate;
}

/* Lluvia reutilizable (añade líneas finas, muy suaves) */
body.weather-rain::before,
body.weather-drizzle::before {
  background-image: linear-gradient(180deg, rgba(44,62,80,0.06), rgba(44,62,80,0));
  background-size: 2px 26px;
  opacity: 0.20;
  animation: rain-fall 2s linear infinite;
}

/* Tormenta: flash tenue */
body.weather-thunderstorm::before {
  background: radial-gradient(circle at 48% 42%, rgba(255,255,255,0.14) 0%, rgba(255,255,255,0) 40%);
  opacity: 0;
  animation: soft-flash 26s ease-in-out infinite;
}

/* Niebla: banda horizontal difusa */
body.weather-mist::before,
body.weather-fog::before {
  background: linear-gradient(90deg, rgba(255,255,255,0.22), rgba(255,255,255,0));
  filter: blur(10px);
  animation: mist-drift 30s ease-in-out infinite alternate;
}

/* ---------- Animaciones ---------- */
@keyframes clouds-drift {
  from { transform: translate3d(-4%, 0, 0) scale(1.03); opacity: 0.75; }
  to   { transform: translate3d(4%, 2%, 0) scale(1.0); opacity: 0.9; }
}

@keyframes rain-fall {
  from { background-position: 0 -32px; }
  to   { background-position: 0 32px; }
}

@keyframes soft-flash {
  0%, 92%, 100% { opacity: 0; filter: brightness(1); }
  94% { opacity: 0.35; filter: brightness(1.06); }
  96% { opacity: 0.15; filter: brightness(1.03); }
  98% { opacity: 0;   filter: brightness(1); }
}

@keyframes mist-drift {
  from { transform: translate3d(-3%, 0, 0) scale(1.02); opacity: 0.55; }
  to   { transform: translate3d(3%, 0, 0) scale(1.0); opacity: 0.65; }
}